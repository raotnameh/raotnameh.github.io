---
layout: single
title: Understanding Automatic SPeech Recognition(ASR) 
excerpt: "The whole Pipeline"
header:
  overlay_color: "#333"
share: false
toc: true

#date:   2019-10-12 16:16:01 -0600


---


 The whole pipeline to convert speech to text is known as Automatic Speech Recognition (ASR), which formes the basis for Google's voice assistant sysytems. In this article, you'll learn about the intuition behind the ASR. The article is divided into the following sections:

+ The Big Picture 
+ Understanding Individual elements of ASR pipeline
+ Handling OOV words.

## The Big Picture
ASR Pipeline contains mainly 2 main components: Acoustic Model and a Language Model. The acoustic model is responsible for the acoustic representation and the language models come into the picture to make sense out of the predicted text. Language model also plays an importatn role when there is ambguity in the predictted text. for example, I <blank> you, if you have to choose between NO and KNOW which one whould you choose?
Ofcourse the second one, but why and how you do that? I would say because you have language understanding as one of your cognitive skills,that's how you  did it.  <br /> 
<br />
let's look at a diagram of the whole pipeline, as shown in Fig. 1:
<p align='center'>
<img src="/assets/images/asr/asr_pipeline.png">
<figcaption align='center'>Fig.1 ASR Pipeline.</figcaption>
</p>

<!-- <iframe src="/assets/images/asr/m.pdf" width="800" height="500"> -->


## Understanding Individual elements of ASR pipeline 
<!-- 
+ Find the probabilities of going from one web page to another (respresented using probability transition matrix)
+ Apply the page rank algorithm our the web page until it converges.
 -->
### Input Audio 
+ Audio : Input is a RAW Audio signal/waveform, which is just the pressure waves recorded/stored digitally at a certain interval of time, or at a certain frequency. 
+ Spectrogram : It's a better representation of an Audio signal, to fed to a Neural Network.
+ Acoustic Model : Acoustic models calculates/determines the probabiltiy of output(Y) conditioned on an input(X). The input is either Raw audio or spectrogram and the output is the predicted transcription.  

<br />

 $$ P(Y/X)
 $$
<br />
### STEP 2
The page rank of each web page is determined by applying the PageRank equation. This process is repeated until the algorithm converges i.e. the values of page rank do not change beyond a small value ( know as epsilon usually fixed as 1e-4 ). The damping factor (d) introduced is to add some randomness over the web graph i.e. d is a probability that a user will move to the linked web page and 1-d is the probability of choosing a random web page, it is usually taken as 0.85.
#### Iteration 1: 
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
 <p align='center'>
<img src="/assets/images/Page_rank/formula.JPEG">
</p>
\begin{equation}
 For each input Acoustic model ouputs probability of a set of pre-defined characters i.e. P(Y/X)  
\end{equation}
<br />
The PR(C) can also be calculated by matrix dot product. 
<p align='center'>
<img src="/assets/images/Page_rank/pr_c.JPEG">
</p>
Similarly, extending this for all the web pages we end up with the equation:  <br />  ( * represents matrix multiplication)
<p align='center'>
<img src="/assets/images/Page_rank/eq.JPEG">
</p>

\begin{equation}
 PR=(1-d)(1/N)+ d* (C^T*PR) 
\end{equation}



Where matrix C represents the probability transition ( C[i][j] = probability of the user transitioning from page i to page j).
The C matrix of our example can be expressed as the matrix represented above. Also, the initial page ranks are as assigned 1 for all the web pages. The PRs of web pages are calculated until the PRs converge to a certain value.

## Implementing Page Rank
Page Rank implementation in python:
```python
import numpy as np
def pagerank(C, eps=0.0001, d=0.85):
    P = np.ones(len(C)) 
    while True:
        P_ = np.ones(len(A))*(1/N)* (1 - d) + d * C.T.dot(P)
        delta = abs(P_ - P).sum()
        if delta <= eps:
            return P_
        P = P_
p=pagerank(C)
#result
#p=[1.16, 0.644, 1.19, 0.15]
```
Final ranking of our example are C > A > B > D !

Notice: page rank of A is high even when it has only one incoming link.

## References
+ [Page Rank Explained](https://www.cs.princeton.edu/~chazelle/courses/BIB/pagerank.htm)

+ [Wikipedia Pagerank](https://en.wikipedia.org/wiki/PageRank#Iterative)
